# Раздел 7: Инвариантные подпространства, собственные значения и диагонализация

## 1. Введение и мотивация

Представьте, что у вас есть сложный линейный оператор $\phi: V \to V$. Как понять его действие? Идеально было бы найти такой базис в пространстве $V$, в котором матрица этого оператора имела бы максимально простой вид, например, диагональный. Если такой базис существует, то действие оператора сводится к простому растяжению или сжатию вдоль направлений базисных векторов.

Как найти такой базис? И всегда ли он существует? Ответы на эти вопросы лежат в основе **спектральной теории** операторов.

Ключевые идеи здесь:

1.  **Инвариантные подпространства:** Это подпространства $U \subseteq V$, которые оператор $\phi$ "не выводит" из себя, то есть $\phi(U) \subseteq U$. Если мы можем разложить все пространство $V$ в прямую сумму таких инвариантных подпространств $V = U_1 \oplus U_2 \oplus \dots \oplus U_k$, то изучение оператора $\phi$ на всем $V$ сводится к изучению его "сужений" на каждом $U_i$ независимо. Это значительно упрощает задачу, так как матрица оператора в базисе, согласованном с этим разложением, будет иметь блочно-диагональный вид.
2.  **Собственные векторы и значения:** Самые простые нетривиальные инвариантные подпространства — одномерные. Если $\operatorname{span}\{v\}$ инвариантно ($v \neq 0$), это значит, что $\phi(v)$ коллинеарен $v$, то есть $\phi(v) = \lambda v$ для некоторого скаляра $\lambda$. Такой ненулевой вектор $v$ называется **собственным вектором**, а скаляр $\lambda$ — **собственным значением**. Они показывают "особые" направления, вдоль которых оператор действует как простое растяжение (с коэффициентом $\lambda$).
3.  **Диагонализация:** Если удается найти базис, состоящий целиком из собственных векторов оператора $\phi$, то в этом базисе матрица оператора будет диагональной, а на диагонали будут стоять соответствующие собственные значения. Такой оператор называется **диагонализируемым**. Наша цель — понять, когда оператор диагонализируем и как найти этот "хороший" базис.

Итак, мы будем искать инвариантные подпространства, определять собственные векторы и значения, находить условия диагонализируемости оператора.

## 2. Основные определения и обозначения

Пусть $\phi \in \operatorname{End}(V)$ — линейный оператор на векторном пространстве $V$ над полем $K$.

*   **Инвариантное подпространство:**
    Подпространство $U \subseteq V$ называется **инвариантным** относительно оператора $\phi$, если для любого вектора $u \in U$ его образ $\phi(u)$ также принадлежит $U$. То есть $\phi(U) \subseteq U$.
    *   **Тривиальные примеры:** Всегда инвариантны нулевое подпространство $\{0_V\}$ и все пространство $V$. Также всегда инвариантны ядро $\ker \phi$ и образ $\operatorname{Im} \phi$. (Почему?)

*   **Ограничение (сужение) оператора:**
    Если $U$ — инвариантное подпространство для $\phi$, то можно рассмотреть **ограничение** оператора $\phi$ на $U$, обозначаемое $\phi|_U$. Это новый оператор $\phi|_U: U \to U$, который действует по тому же правилу, что и $\phi$, но только на векторы из $U$: $(\phi|_U)(u) = \phi(u)$ для $u \in U$.

*   **Собственный вектор и собственное значение:**
    Ненулевой вектор $v \in V$ называется **собственным вектором** оператора $\phi$, если существует такой скаляр $\lambda \in K$, что:
    $$ \phi(v) = \lambda v $$
    Скаляр $\lambda$ называется **собственным значением** (или собственным числом) оператора $\phi$, соответствующим собственному вектору $v$.

*   **Спектр оператора:**
    Множество всех собственных значений оператора $\phi$ называется его **спектром** и обозначается $\operatorname{Spec}(\phi)$.

*   **Собственное подпространство:**
    Для каждого собственного значения $\lambda \in \operatorname{Spec}(\phi)$ множество всех собственных векторов, соответствующих этому $\lambda$, дополненное нулевым вектором, образует подпространство. Оно называется **собственным подпространством**, соответствующим $\lambda$, и обозначается $V_\lambda$ или $E_\lambda$:
    $$ V_\lambda = \{ v \in V \mid \phi(v) = \lambda v \} = \{ v \in V \mid (\phi - \lambda id_V)(v) = 0_V \} $$
    Таким образом, $V_\lambda = \ker(\phi - \lambda id_V)$.

*   **Характеристический многочлен:**
    Если $\dim V = n < \infty$, то **характеристическим многочленом** оператора $\phi$ называется многочлен от переменной $\lambda$:
    $$ \chi_\phi(\lambda) = \det(\phi - \lambda id_V) $$
    Если $A = [\phi]_{\mathcal{E}}$ — матрица оператора в некотором базисе $\mathcal{E}$, то характеристический многочлен можно вычислить как:
    $$ \chi_\phi(\lambda) = \det(A - \lambda I) $$
    где $I$ — единичная матрица. Характеристический многочлен не зависит от выбора базиса. Это многочлен степени $n$ относительно $\lambda$.

*   **Алгебраическая кратность собственного значения:**
    **Алгебраической кратностью** собственного значения $\lambda_0 \in \operatorname{Spec}(\phi)$ называется его кратность как корня характеристического многочлена $\chi_\phi(\lambda)$.

*   **Геометрическая кратность собственного значения:**
    **Геометрической кратностью** собственного значения $\lambda_0 \in \operatorname{Spec}(\phi)$ называется размерность соответствующего ему собственного подпространства $V_{\lambda_0}$.
    $$ \text{геометр. кратность}(\lambda_0) = \dim V_{\lambda_0} = \dim(\ker(\phi - \lambda_0 id_V)) $$

*   **Диагонализируемый оператор:**
    Оператор $\phi \in \operatorname{End}(V)$ называется **диагонализируемым**, если существует базис пространства $V$, состоящий из собственных векторов оператора $\phi$. В таком базисе матрица оператора $\phi$ будет диагональной.

## 3. Ключевые утверждения (теоремы/свойства)

1.  **Собственные значения — корни характеристического многочлена:** Скаляр $\lambda \in K$ является собственным значением оператора $\phi$ (на конечномерном $V$) тогда и только тогда, когда он является корнем характеристического многочлена $\chi_\phi(\lambda) = 0$.
    *   *Следствие:* Оператор на $n$-мерном пространстве имеет не более $n$ различных собственных значений. Над алгебраически замкнутым полем (например, $\mathbb{C}$) он имеет ровно $n$ собственных значений, если считать их с учетом алгебраической кратности.
2.  **Линейная независимость собственных векторов:** Собственные векторы, соответствующие *различным* собственным значениям, линейно независимы.
3.  **Связь кратностей:** Для любого собственного значения $\lambda_0$ его геометрическая кратность не превосходит его алгебраической кратности:
    $$ 1 \le \dim V_{\lambda_0} \le \text{алгебр. кратность}(\lambda_0) $$
4.  **Свойства собственных векторов/значений для простых операторов:**
    *   **Нуль-оператор** $\mathbf{0}$: Единственное собственное значение $\lambda=0$. Любой ненулевой вектор является собственным. $V_0 = V$.
    *   **Тождественный оператор** $id_V$: Единственное собственное значение $\lambda=1$. Любой ненулевой вектор является собственным. $V_1 = V$.
    *   **Оператор растяжения** $\phi(v) = c v$: Единственное собственное значение $\lambda=c$. Любой ненулевой вектор является собственным. $V_c = V$.
5.  **Критерии диагонализируемости (для конечномерного V):** Следующие условия эквивалентны:
    *   Оператор $\phi$ диагонализируем.
    *   Существует базис $V$, состоящий из собственных векторов $\phi$.
    *   Пространство $V$ является прямой суммой собственных подпространств оператора $\phi$: $V = \bigoplus_{\lambda \in \operatorname{Spec}(\phi)} V_\lambda$.
    *   Размерность $V$ равна сумме размерностей всех собственных подпространств: $\dim V = \sum_{\lambda \in \operatorname{Spec}(\phi)} \dim V_\lambda$.
    *   Характеристический многочлен $\chi_\phi(\lambda)$ разлагается на линейные множители над полем $K$ (т.е. все его корни принадлежат $K$), *и* для каждого собственного значения $\lambda_i$ его алгебраическая кратность равна его геометрической кратности ($\dim V_{\lambda_i}$).
6.  **Спектральное разложение (для диагонализируемого оператора):** Если $\phi$ диагонализируем и $V = \bigoplus_{i=1}^k V_{\lambda_i}$ — разложение в прямую сумму собственных подпространств, то существуют операторы-проекторы $P_i: V \to V_{\lambda_i}$ такие, что:
    *   $P_i \circ P_j = 0$ при $i \neq j$
    *   $P_i \circ P_i = P_i$ (проектор)
    *   $\sum_{i=1}^k P_i = id_V$
    *   $\phi = \sum_{i=1}^k \lambda_i P_i$
    Эта последняя формула называется **спектральным разложением** оператора $\phi$. Она показывает, что действие $\phi$ — это взвешенная сумма проекций на собственные подпространства.

## 4. Практические примеры — пошаговый разбор

**Пример 1: Найти собственные значения и собственные векторы.**

*   **Постановка:** Найти собственные значения и собственные векторы оператора $\phi: \mathbb{R}^2 \to \mathbb{R}^2$, заданного матрицей $A = \begin{pmatrix} 4 & -2 \\ 1 & 1 \end{pmatrix}$.
*   **Шаг 1: Найти характеристический многочлен.**
    $$ \chi_\phi(\lambda) = \det(A - \lambda I) = \det \begin{pmatrix} 4-\lambda & -2 \\ 1 & 1-\lambda \end{pmatrix} $$
    $$ = (4-\lambda)(1-\lambda) - (-2)(1) = 4 - 4\lambda - \lambda + \lambda^2 + 2 = \lambda^2 - 5\lambda + 6 $$
*   **Шаг 2: Найти собственные значения.** Решаем уравнение $\chi_\phi(\lambda) = 0$:
    $$ \lambda^2 - 5\lambda + 6 = 0 $$
    По теореме Виета, корни $\lambda_1 = 2$, $\lambda_2 = 3$. Это и есть собственные значения. $\operatorname{Spec}(\phi) = \{2, 3\}$. Алгебраическая кратность каждого равна 1.
*   **Шаг 3: Найти собственные векторы для $\lambda_1 = 2$.** Решаем систему $(A - \lambda_1 I)X = 0$:
    $$ (A - 2I)X = \begin{pmatrix} 4-2 & -2 \\ 1 & 1-2 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 2 & -2 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix} $$
    Система сводится к уравнению $x - y = 0$, или $x=y$. Общее решение $X = \begin{pmatrix} y \\ y \end{pmatrix} = y \begin{pmatrix} 1 \\ 1 \end{pmatrix}$.
    Собственные векторы для $\lambda_1 = 2$: $v_1 = c \begin{pmatrix} 1 \\ 1 \end{pmatrix}$, где $c \neq 0$.
    Собственное подпространство $V_2 = \operatorname{span}\{(1, 1)^T\}$. Геометрическая кратность $\dim V_2 = 1$.
*   **Шаг 4: Найти собственные векторы для $\lambda_2 = 3$.** Решаем систему $(A - \lambda_2 I)X = 0$:
    $$ (A - 3I)X = \begin{pmatrix} 4-3 & -2 \\ 1 & 1-3 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 1 & -2 \\ 1 & -2 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix} $$
    Система сводится к уравнению $x - 2y = 0$, или $x=2y$. Общее решение $X = \begin{pmatrix} 2y \\ y \end{pmatrix} = y \begin{pmatrix} 2 \\ 1 \end{pmatrix}$.
    Собственные векторы для $\lambda_2 = 3$: $v_2 = c \begin{pmatrix} 2 \\ 1 \end{pmatrix}$, где $c \neq 0$.
    Собственное подпространство $V_3 = \operatorname{span}\{(2, 1)^T\}$. Геометрическая кратность $\dim V_3 = 1$.
*   **Ответ:** Собственные значения: $\lambda_1=2, \lambda_2=3$. Соответствующие собственные векторы: $v_1 = c(1, 1)^T$ и $v_2 = c(2, 1)^T$ ($c \neq 0$).

**Пример 2: Проверка на диагонализируемость и диагонализация.**

*   **Постановка:** Диагонализируем ли оператор $\phi$ из Примера 1? Если да, найти базис, в котором его матрица диагональна, и саму диагональную матрицу.
*   **Шаг 1: Проверить критерий диагонализируемости.**
    *   Характеристический многочлен $\chi_\phi(\lambda) = (\lambda-2)(\lambda-3)$ разлагается на линейные множители над $\mathbb{R}$.
    *   Для $\lambda_1=2$: алгебраическая кратность = 1, геометрическая кратность = $\dim V_2 = 1$. Они равны.
    *   Для $\lambda_2=3$: алгебраическая кратность = 1, геометрическая кратность = $\dim V_3 = 1$. Они равны.
    *   Все условия выполнены. Оператор диагонализируем.
*   **Шаг 2: Найти базис из собственных векторов.** Мы уже нашли по одному базисному вектору для каждого собственного подпространства: $b_1 = (1, 1)^T$ для $V_2$ и $b_2 = (2, 1)^T$ для $V_3$. Так как они соответствуют разным собственным значениям, они линейно независимы. В $\mathbb{R}^2$ два линейно независимых вектора образуют базис.
    Итак, $\mathcal{B} = \{b_1, b_2\} = \{(1, 1)^T, (2, 1)^T\}$ — искомый базис.
*   **Шаг 3: Найти диагональную матрицу.** В базисе $\mathcal{B}$ матрица оператора $D = [\phi]_{\mathcal{B}}$ будет диагональной. На диагонали стоят собственные значения, соответствующие базисным векторам *в том же порядке*.
    $$ D = \begin{pmatrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{pmatrix} = \begin{pmatrix} 2 & 0 \\ 0 & 3 \end{pmatrix} $$
*   **Шаг 4 (Необязательно): Найти матрицу перехода.** Матрица перехода $T$ от стандартного базиса $\mathcal{E}$ к базису $\mathcal{B}$ составляется из координатных столбцов векторов $b_1, b_2$ в базисе $\mathcal{E}$:
    $$ T = \begin{pmatrix} 1 & 2 \\ 1 & 1 \end{pmatrix} $$
    Тогда должно выполняться соотношение подобия: $D = T^{-1} A T$. Проверим.
    Найдем $T^{-1}$. $\det T = 1(1) - 2(1) = -1$.
    $$ T^{-1} = \frac{1}{-1} \begin{pmatrix} 1 & -2 \\ -1 & 1 \end{pmatrix} = \begin{pmatrix} -1 & 2 \\ 1 & -1 \end{pmatrix} $$
    Вычислим $T^{-1} A T$:
    $$ T^{-1} A = \begin{pmatrix} -1 & 2 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} 4 & -2 \\ 1 & 1 \end{pmatrix} = \begin{pmatrix} -4+2 & 2+2 \\ 4-1 & -2-1 \end{pmatrix} = \begin{pmatrix} -2 & 4 \\ 3 & -3 \end{pmatrix} $$
    $$ (T^{-1} A) T = \begin{pmatrix} -2 & 4 \\ 3 & -3 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 1 & 1 \end{pmatrix} = \begin{pmatrix} -2+4 & -4+4 \\ 3-3 & 6-3 \end{pmatrix} = \begin{pmatrix} 2 & 0 \\ 0 & 3 \end{pmatrix} $$
    Получили матрицу $D$. Все верно.
*   **Ответ:** Оператор диагонализируем. Базис из собственных векторов: $\mathcal{B} = \{(1, 1)^T, (2, 1)^T\}$. Диагональная матрица в этом базисе: $D = \begin{pmatrix} 2 & 0 \\ 0 & 3 \end{pmatrix}$.

## 5. Задачи для самопроверки

1.  Найдите собственные значения, собственные векторы, алгебраические и геометрические кратности для оператора, заданного матрицей $A = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$. Диагонализируем ли этот оператор над $\mathbb{R}$? Над $\mathbb{C}$?
2.  Докажите, что ядро $\ker \phi$ и образ $\operatorname{Im} \phi$ являются инвариантными подпространствами для $\phi$.
3.  Пусть $v_1, v_2$ — собственные векторы оператора $\phi$, соответствующие различным собственным значениям $\lambda_1, \lambda_2$. Докажите, что $v_1, v_2$ линейно независимы.
4.  Оператор $\phi$ на $V$ диагонализируем. Будет ли диагонализируем оператор $\phi^2 = \phi \circ \phi$? Если да, то какие у него будут собственные значения и векторы?
5.  Найдите все инвариантные подпространства для оператора из Примера 1 ($A = \begin{pmatrix} 4 & -2 \\ 1 & 1 \end{pmatrix}$).

## 6. Краткое резюме

*   **Инвариантное подпространство** $U$: $\phi(U) \subseteq U$. Позволяют упростить структуру оператора.
*   **Собственный вектор $v \neq 0$ и собственное значение $\lambda$**: $\phi(v) = \lambda v$. Показывают направления, вдоль которых оператор действует как растяжение.
*   **Собственное подпространство $V_\lambda = \ker(\phi - \lambda id)$:** Пространство, натянутое на собственные векторы для $\lambda$ (и нулевой вектор).
*   **Характеристический многочлен $\chi_\phi(\lambda) = \det(\phi - \lambda id)$:** Его корни — это собственные значения.
*   **Алгебраическая кратность** (кратность корня $\chi_\phi(\lambda)$) $\ge$ **Геометрическая кратность** ($\dim V_\lambda$).
*   **Диагонализируемость оператора $\phi$** эквивалентна существованию базиса из собственных векторов, что равносильно разложению $V$ в прямую сумму собственных подпространств $V = \bigoplus V_\lambda$. Это выполняется, если $\chi_\phi(\lambda)$ расщепляется над полем $K$ и для всех $\lambda$ алгебраическая кратность равна геометрической.
*   В базисе из собственных векторов матрица оператора диагональна, с собственными значениями на диагонали.

Понимание собственных значений, векторов и диагонализации является центральным в линейной алгебре и находит широчайшее применение в дифференциальных уравнениях, квантовой механике, анализе данных и многих других областях. Однако не все операторы диагонализируемы, что приводит нас к необходимости изучения более общей структуры — жордановой нормальной формы.