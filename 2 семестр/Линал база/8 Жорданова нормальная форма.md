# Раздел 8: Жорданова нормальная форма

## 1. Введение и мотивация

Мы видели, что диагональная матрица — это идеальный вариант представления оператора. Но что делать, если собственных векторов "не хватает" для построения базиса? Идея Жордана состоит в том, чтобы дополнить базис из собственных векторов так называемыми **корневыми (или присоединенными) векторами**. Эти векторы не являются собственными в чистом виде (т.е. $\phi(v) \neq \lambda v$), но они связаны с собственными значениями и образуют специальные цепочки, называемые **жордановыми цепочками**.

Ключевые идеи:

1.  **Корневые подпространства:** Вместо того чтобы рассматривать только ядро $\ker(\phi - \lambda id)$ (собственное подпространство $V_\lambda$), мы будем рассматривать ядро более высоких степеней этого оператора: $\ker(\phi - \lambda id)^k$. Объединение этих ядер для всех $k$ образует **корневое подпространство** $K_\lambda$, соответствующее собственному значению $\lambda$. Оказывается, все пространство $V$ (над алгебраически замкнутым полем) разлагается в прямую сумму таких корневых подпространств: $V = \bigoplus K_\lambda$.
2.  **Нильпотентные операторы:** Изучение действия оператора $\phi$ на корневом подпространстве $K_\lambda$ сводится к изучению оператора $N = \phi - \lambda id$ на этом же подпространстве. Этот оператор $N$ обладает свойством **нильпотентности**, то есть $N^k = 0$ для некоторого $k$. Структура нильпотентных операторов описывается с помощью **жордановых клеток**.
3.  **Жорданова клетка и ЖНФ:** В специальном **жордановом базисе**, составленном из жордановых цепочек корневых векторов, матрица оператора $\phi$ имеет блочно-диагональный вид. Каждый блок соответствует одному корневому подпространству $K_\lambda$, а внутри этого блока располагаются **жордановы клетки** — матрицы особого вида, с собственным значением $\lambda$ на диагонали и единицами над главной диагональю. Эта блочно-диагональная матрица и называется **Жордановой нормальной формой (ЖНФ)**.

ЖНФ дает каноническое представление *любого* оператора над $\mathbb{C}$ (и некоторых над $\mathbb{R}$) и позволяет полностью понять его структуру, даже если он не диагонализируем. Она имеет огромное значение в теории дифференциальных уравнений (для решения систем), теории управления, анализе динамических систем.

## 2. Основные определения и обозначения

Пусть $\phi \in \operatorname{End}(V)$, $\dim V = n < \infty$, и поле $K$ таково, что характеристический многочлен $\chi_\phi(\lambda)$ разлагается на линейные множители над $K$ (например, $K = \mathbb{C}$). Пусть $\lambda_1, \dots, \lambda_s$ — *различные* собственные значения $\phi$.

*   **Корневой вектор:**
    Ненулевой вектор $v \in V$ называется **корневым вектором**, относящимся к собственному значению $\lambda$, если существует такое натуральное число $k \ge 1$, что:
    $$ (\phi - \lambda id_V)^k (v) = 0_V $$
    *   Собственный вектор — это корневой вектор с $k=1$.

*   **Высота корневого вектора:**
    **Высотой** корневого вектора $v$ (относящегося к $\lambda$) называется *наименьшее* натуральное $k$, для которого $(\phi - \lambda id)^k (v) = 0$. Собственные векторы имеют высоту 1.

*   **Корневое подпространство:**
    Для каждого собственного значения $\lambda$ множество всех корневых векторов, относящихся к $\lambda$, дополненное нулевым вектором, образует подпространство. Оно называется **корневым подпространством**, соответствующим $\lambda$, и обозначается $K_\lambda$:
    $$ K_\lambda = \{ v \in V \mid \exists k \ge 1: (\phi - \lambda id)^k (v) = 0 \} = \bigcup_{k=1}^\infty \ker(\phi - \lambda id)^k $$
    *   Для конечномерного $V$ эта цепочка ядер стабилизируется, т.е. существует такое $m$, что $K_\lambda = \ker(\phi - \lambda id)^m$.

*   **Нильпотентный оператор:**
    Оператор $N \in \operatorname{End}(U)$ называется **нильпотентным**, если существует такое натуральное число $k$, что $N^k = \mathbf{0}$ (нулевой оператор). Наименьшее такое $k$ называется **степенью нильпотентности**.

*   **Жорданова цепочка:**
    Для оператора $\phi$ и его собственного значения $\lambda$, набор векторов $\{v_1, v_2, \dots, v_k\}$ называется **жордановой цепочкой** длины $k$, если:
    *   $v_k$ — корневой вектор высоты $k$, т.е. $(\phi - \lambda id)^k(v_k) = 0$ и $(\phi - \lambda id)^{k-1}(v_k) \neq 0$.
    *   Векторы цепочки связаны соотношениями:
        $$ (\phi - \lambda id)(v_1) = 0 \quad (\text{т.е. } v_1 \in V_\lambda) $$
        $$ (\phi - \lambda id)(v_2) = v_1 $$
        $$ (\phi - \lambda id)(v_3) = v_2 $$
        $$ \dots $$
        $$ (\phi - \lambda id)(v_k) = v_{k-1} $$
    Вектор $v_k$ называется **присоединенным вектором** (или образующим цепочки), а $v_1$ — собственный вектор.

*   **Жорданова клетка:**
    Квадратная матрица $J_k(\lambda)$ порядка $k$ вида:
    $$ J_k(\lambda) = \begin{pmatrix} \lambda & 1 & 0 & \dots & 0 \\ 0 & \lambda & 1 & \dots & 0 \\ 0 & 0 & \lambda & \dots & 0 \\ \vdots & \vdots & \vdots & \ddots & 1 \\ 0 & 0 & 0 & \dots & \lambda \end{pmatrix} $$
    (на главной диагонали стоит $\lambda$, на диагонали над ней — единицы, остальные элементы — нули).
    *   Если $k=1$, то $J_1(\lambda) = (\lambda)$.
    *   **Нильпотентная жорданова клетка:** Это $J_k(0)$ (с нулями на диагонали). Ее порядок $k$ — это размер клетки, а также степень нильпотентности соответствующего оператора.

*   **Жорданова нормальная форма (ЖНФ):**
    Матрица $J$ называется матрицей в **Жордановой нормальной форме**, если она является блочно-диагональной, и каждый блок на диагонали является жордановой клеткой:
    $$ J = \begin{pmatrix} J_{k_1}(\lambda_1) & 0 & \dots & 0 \\ 0 & J_{k_2}(\lambda_2) & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & J_{k_m}(\lambda_m) \end{pmatrix} $$
    где $\lambda_1, \dots, \lambda_m$ — собственные значения оператора (не обязательно различные).

*   **Жорданов блок:**
    Совокупность всех жордановых клеток в ЖНФ, относящихся к *одному и тому же* собственному значению $\lambda$, называется **жордановым блоком**, соответствующим $\lambda$. Жорданов блок — это тоже блочно-диагональная матрица. Оператор диагонализируем тогда и только тогда, когда все его жордановы клетки имеют размер $1 \times 1$.

*   **Жорданов базис:**
    Базис пространства $V$, в котором матрица оператора $\phi$ имеет Жорданову нормальную форму. Он строится как объединение жордановых цепочек, соответствующих всем жордановым клеткам.

## 3. Ключевые утверждения (теоремы/свойства)

1.  **Свойства корневых подпространств:**
    *   Каждое корневое подпространство $K_\lambda$ является **инвариантным** относительно $\phi$.
    *   Размерность $\dim K_\lambda$ равна **алгебраической кратности** собственного значения $\lambda$.
    *   Корневые подпространства, соответствующие *различным* собственным значениям, **линейно независимы** (их пересечение — только $\{0_V\}$).
2.  **Теорема о корневом разложении:** Если характеристический многочлен $\chi_\phi(\lambda)$ оператора $\phi$ разлагается на линейные множители над полем $K$ (т.е. все корни принадлежат $K$), то пространство $V$ является **прямой суммой** корневых подпространств:
    $$ V = K_{\lambda_1} \oplus K_{\lambda_2} \oplus \dots \oplus K_{\lambda_s} = \bigoplus_{i=1}^s K_{\lambda_i} $$
    где $\lambda_1, \dots, \lambda_s$ — все *различные* собственные значения $\phi$.
3.  **Сведение к нильпотентному оператору:** Ограничение оператора $\phi$ на корневое подпространство $K_\lambda$ можно представить как $\phi|_{K_\lambda} = \lambda id_{K_\lambda} + N_\lambda$, где $N_\lambda = (\phi - \lambda id)|_{K_\lambda}$ является **нильпотентным** оператором на $K_\lambda$.
4.  **Теорема о структуре нильпотентного оператора:** Для любого нильпотентного оператора $N$ на пространстве $U$ существует базис, состоящий из объединения нескольких жордановых цепочек, в котором матрица оператора $N$ является блочно-диагональной, состоящей из **нильпотентных** жордановых клеток $J_k(0)$. Эта форма единственна с точностью до перестановки клеток.
5.  **Теорема о Жордановой нормальной форме:** Для любого линейного оператора $\phi$ на конечномерном векторном пространстве $V$ над алгебраически замкнутым полем $K$ (например, $K=\mathbb{C}$) существует базис (жорданов базис), в котором матрица оператора $\phi$ имеет Жорданову нормальную форму $J$. Эта форма $J$ **единственна** с точностью до перестановки жордановых блоков (и клеток внутри блоков).
    *   *Следствие:* Любая квадратная матрица над $\mathbb{C}$ подобна своей ЖНФ.
6.  **Структура ЖНФ:**
    *   Число жордановых блоков в ЖНФ равно числу *различных* собственных значений оператора.
    *   Для каждого собственного значения $\lambda$, соответствующий жорданов блок состоит из одной или нескольких жордановых клеток вида $J_k(\lambda)$.
    *   **Число жордановых клеток** $J_k(\lambda)$ в блоке, соответствующем $\lambda$, равно **геометрической кратности** этого $\lambda$, то есть $\dim V_\lambda$.
    *   Сумма порядков всех жордановых клеток $J_k(\lambda)$, относящихся к одному $\lambda$, равна **алгебраической кратности** этого $\lambda$ (т.е. размеру жорданова блока $\dim K_\lambda$).
    *   Порядок самой большой жордановой клетки $J_k(\lambda)$ для данного $\lambda$ равен степени нильпотентности оператора $N_\lambda = (\phi - \lambda id)|_{K_\lambda}$.

## 4. Практические примеры — пошаговый разбор

**Пример 1: Найти ЖНФ и жорданов базис.**

*   **Постановка:** Найти ЖНФ и жорданов базис для оператора $\phi$, заданного матрицей $A = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$.
*   **Шаг 1: Найти собственные значения.**
    $$ \chi_\phi(\lambda) = \det(A - \lambda I) = \det \begin{pmatrix} 1-\lambda & 1 \\ 0 & 1-\lambda \end{pmatrix} = (1-\lambda)^2 $$
    Единственное собственное значение $\lambda_1 = 1$ с алгебраической кратностью 2.
*   **Шаг 2: Найти геометрическую кратность.** Ищем $\dim V_1 = \dim(\ker(A - 1I))$.
    $$ A - 1I = \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix} $$
    Система $(A - I)X = 0$ имеет вид $0x + 1y = 0$, т.е. $y=0$. Общее решение $X = \begin{pmatrix} x \\ 0 \end{pmatrix} = x \begin{pmatrix} 1 \\ 0 \end{pmatrix}$.
    Базис $V_1$ состоит из одного вектора $e_1 = (1, 0)^T$. Геометрическая кратность $\dim V_1 = 1$.
*   **Шаг 3: Определить структуру ЖНФ.**
    *   Собственное значение одно: $\lambda=1$. Значит, будет один жорданов блок.
    *   Размер блока равен алгебраической кратности, т.е. 2.
    *   Число клеток в блоке равно геометрической кратности, т.е. 1.
    *   Значит, блок состоит из одной жордановой клетки порядка 2, относящейся к $\lambda=1$.
    ЖНФ: $J = J_2(1) = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$. (В данном случае матрица уже была в ЖНФ).
*   **Шаг 4: Найти жорданов базис.** Нам нужна жорданова цепочка $\{v_1, v_2\}$ длины 2 такая, что $(\phi - id)v_1 = 0$ и $(\phi - id)v_2 = v_1$.
    *   В качестве $v_1$ (собственного вектора) возьмем $v_1 = e_1 = (1, 0)^T$.
    *   Ищем $v_2 = (x, y)^T$ из уравнения $(A - I)v_2 = v_1$:
        $$ \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 1 \\ 0 \end{pmatrix} $$
        Система: $0x + 1y = 1$, $0x + 0y = 0$. Отсюда $y=1$, а $x$ может быть любым. Выберем $x=0$. Получаем $v_2 = (0, 1)^T$.
    *   Жорданов базис: $\mathcal{B} = \{v_1, v_2\} = \{(1, 0)^T, (0, 1)^T\}$. (Это стандартный базис, так как исходная матрица уже была ЖНФ).
*   **Ответ:** ЖНФ $J = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$. Жорданов базис $\mathcal{B} = \{(1, 0)^T, (0, 1)^T\}$.

**Пример 2: Более сложный случай.**

*   **Постановка:** Найти ЖНФ для матрицы $A = \begin{pmatrix} 3 & 1 & 0 \\ -1 & 1 & 0 \\ 0 & 0 & 2 \end{pmatrix}$.
*   **Шаг 1: Характеристический многочлен.**
    $$ \det(A - \lambda I) = \det \begin{pmatrix} 3-\lambda & 1 & 0 \\ -1 & 1-\lambda & 0 \\ 0 & 0 & 2-\lambda \end{pmatrix} = (2-\lambda) \det \begin{pmatrix} 3-\lambda & 1 \\ -1 & 1-\lambda \end{pmatrix} $$
    $$ = (2-\lambda) [(3-\lambda)(1-\lambda) - (1)(-1)] = (2-\lambda) [3 - 4\lambda + \lambda^2 + 1] $$
    $$ = (2-\lambda) (\lambda^2 - 4\lambda + 4) = (2-\lambda) (\lambda - 2)^2 = -(\lambda - 2)^3 $$
    Единственное собственное значение $\lambda_1 = 2$ с алгебраической кратностью 3.
*   **Шаг 2: Геометрическая кратность.** Ищем $\dim V_2 = \dim(\ker(A - 2I))$.
    $$ A - 2I = \begin{pmatrix} 1 & 1 & 0 \\ -1 & -1 & 0 \\ 0 & 0 & 0 \end{pmatrix} $$
    Система $(A - 2I)X = 0$ сводится к одному уравнению $x + y = 0$. Переменная $z$ — свободная. $y = -x$.
    Общее решение: $X = \begin{pmatrix} x \\ -x \\ z \end{pmatrix} = x \begin{pmatrix} 1 \\ -1 \\ 0 \end{pmatrix} + z \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}$.
    Базис $V_2$ состоит из векторов $v_1 = (1, -1, 0)^T$ и $v_2 = (0, 0, 1)^T$. Геометрическая кратность $\dim V_2 = 2$.
*   **Шаг 3: Структура ЖНФ.**
    *   Один блок, относящийся к $\lambda=2$, размер блока 3.
    *   Число клеток в блоке равно геометрической кратности, т.е. 2.
    *   Сумма порядков этих двух клеток должна быть равна размеру блока, т.е. 3. Единственный вариант (с точностью до перестановки): клетки порядков 2 и 1.
    ЖНФ: $J = \begin{pmatrix} J_2(2) & 0 \\ 0 & J_1(2) \end{pmatrix} = \begin{pmatrix} 2 & 1 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{pmatrix}$.
*   **Ответ:** ЖНФ $J = \begin{pmatrix} 2 & 1 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{pmatrix}$. (Нахождение жорданова базиса здесь требует дополнительных вычислений, связанных с поиском корневых векторов высоты 2).

## 5. Задачи для самопроверки

1.  Найдите ЖНФ и жорданов базис для матрицы $A = \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{pmatrix}$. Какова степень нильпотентности этого оператора?
2.  Матрица оператора $\phi$ над $\mathbb{C}$ имеет характеристический многочлен $\chi(\lambda) = -(\lambda - 5)^4 (\lambda + 1)^2$. Геометрическая кратность $\lambda_1=5$ равна 2, а геометрическая кратность $\lambda_2=-1$ равна 1. Каков возможный вид ЖНФ этой матрицы (с точностью до перестановки клеток)? Сколько вариантов?
3.  Докажите, что корневое подпространство $K_\lambda$ инвариантно относительно $\phi$.
4.  Может ли оператор на $\mathbb{R}^3$ иметь ЖНФ $J = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1+i \end{pmatrix}$? Почему?
5.  Что можно сказать о ЖНФ оператора, если его алгебраическая и геометрическая кратности совпадают для всех собственных значений?

## 6. Краткое резюме

*   Если оператор не диагонализируем, его структура описывается **Жордановой нормальной формой (ЖНФ)**.
*   ЖНФ существует для любого оператора над алгебраически замкнутым полем (например, $\mathbb{C}$).
*   ЖНФ — блочно-диагональная матрица, состоящая из **жордановых клеток** $J_k(\lambda)$.
*   Построение ЖНФ опирается на разложение пространства $V$ в прямую сумму **корневых подпространств** $K_\lambda$.
*   Размер корневого подпространства $K_\lambda$ равен **алгебраической кратности** $\lambda$.
*   Структура действия $\phi$ на $K_\lambda$ сводится к $\lambda id + N_\lambda$, где $N_\lambda$ — **нильпотентный оператор**.
*   **Число жордановых клеток** для $\lambda$ равно **геометрической кратности** $\lambda$.
*   **Жорданов базис** строится из **жордановых цепочек** корневых векторов.
*   ЖНФ **единственна** с точностью до перестановки клеток/блоков.

Жорданова нормальная форма — это мощный теоретический инструмент, позволяющий классифицировать линейные операторы и анализировать их свойства даже в "сложных" недиагонализируемых случаях.