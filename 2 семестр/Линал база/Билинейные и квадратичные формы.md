# Раздел 2: Билинейные и квадратичные формы

## 1. Введение и мотивация

Если линейные формы "измеряли" один вектор, то **билинейные формы** $b(u, v)$ принимают *два* вектора и возвращают скаляр, причем они линейны по *каждому* аргументу отдельно.

Почему это важно?

*   **Скалярное произведение:** Самый известный пример билинейной формы — это скалярное произведение в евклидовом пространстве $(\cdot, \cdot)$. Оно симметрично ($(u, v) = (v, u)$) и положительно определено ($ (v, v) > 0 $ для $v \neq 0$).
*   **Метрики в геометрии:** В общей теории относительности и дифференциальной геометрии метрический тензор задает билинейную форму, которая определяет расстояния и углы в искривленных пространствах (она не всегда положительно определена, как в пространстве Минковского).
*   **Связь с квадратичными формами:** Каждая билинейная форма $b(u, v)$ порождает **квадратичную форму** $q(v) = b(v, v)$, которая зависит только от одного вектора, но уже не линейно, а квадратично.
*   **Квадратичные формы:** Они описывают многие важные объекты и явления:
    *   **Геометрия:** Уравнения эллипсов, гипербол, парабол (кривые второго порядка) и их аналогов в 3D (поверхности второго порядка) — это уравнения вида $q(x, y) = \text{const}$ или $q(x, y, z) = \text{const}$.
    *   **Физика:** Кинетическая энергия ($ \frac{1}{2}mv^2 $) — квадратичная форма от скорости. Потенциальная энергия малых колебаний вблизи положения равновесия часто аппроксимируется квадратичной формой.
    *   **Анализ:** Исследование поведения функции нескольких переменных в окрестности критической точки (поиск минимума/максимума) использует квадратичную форму, построенную на матрице вторых производных (гессиане).

Наша цель — понять определение и свойства билинейных форм, их связь с матрицами, как они меняются при замене базиса, и как из них получаются квадратичные формы.

## 2. Основные определения и обозначения

Пусть $V$ — векторное пространство над полем $K$.

*   **Билинейная форма:**
    Отображение $b: V \times V \to K$ называется **билинейной формой**, если оно линейно по каждому аргументу при фиксированном другом:
    1.  $b(\lambda u_1 + \mu u_2, v) = \lambda b(u_1, v) + \mu b(u_2, v)$
    2.  $b(u, \lambda v_1 + \mu v_2) = \lambda b(u, v_1) + \mu b(u, v_2)$
    для любых $u, u_1, u_2, v, v_1, v_2 \in V$ и $\lambda, \mu \in K$.

*   **Матрица билинейной формы:**
    Пусть $\{e_1, \dots, e_n\}$ — базис в $V$. **Матрицей** билинейной формы $b$ в этом базисе называется квадратная матрица $B = (\beta_{ij})$ размера $n \times n$, элементы которой равны значениям формы на парах базисных векторов:
    $$ \beta_{ij} = b(e_i, e_j) $$
    *Значение формы на произвольных векторах $u = \sum u_i e_i$ и $v = \sum v_j e_j$ выражается через матрицу $B$ и столбцы координат $U = (u_1, \dots, u_n)^T$, $V = (v_1, \dots, v_n)^T$:*
    $$ b(u, v) = \sum_{i=1}^n \sum_{j=1}^n u_i \beta_{ij} v_j = U^T B V $$

*   **Симметричная билинейная форма:**
    Билинейная форма $b$ называется **симметричной**, если $b(u, v) = b(v, u)$ для всех $u, v \in V$.
    *Свойство матрицы:* Форма $b$ симметрична тогда и только тогда, когда ее матрица $B$ (в любом базисе) симметрична ($B = B^T$, т.е. $\beta_{ij} = \beta_{ji}$).

*   **Антисимметричная (или кососимметричная) билинейная форма:**
    Билинейная форма $b$ называется **антисимметричной**, если $b(u, v) = -b(v, u)$ для всех $u, v \in V$.
    *Свойство матрицы:* Форма $b$ антисимметрична тогда и только тогда, когда ее матрица $B$ (в любом базисе) антисимметрична ($B = -B^T$, т.е. $\beta_{ij} = -\beta_{ji}$). Отсюда следует, что диагональные элементы антисимметричной матрицы равны нулю ($\beta_{ii} = 0$), если характеристика поля $K \neq 2$.

*   **Разложение билинейной формы:**
    Если характеристика поля $K \neq 2$ (например, для $\mathbb{R}$ или $\mathbb{C}$), любую билинейную форму $b$ можно единственным образом представить в виде суммы симметричной и антисимметричной форм: $b = b_S + b_{AS}$, где:
    *   **Симметричная часть:** $b_S(u, v) = \frac{1}{2} (b(u, v) + b(v, u))$
    *   **Антисимметричная часть:** $b_{AS}(u, v) = \frac{1}{2} (b(u, v) - b(v, u))$
    Их матрицы связаны аналогично: $B_S = \frac{1}{2}(B + B^T)$ и $B_{AS} = \frac{1}{2}(B - B^T)$.

*   **Квадратичная форма:**
    Отображение $q: V \to K$ называется **квадратичной формой**, если оно получено из некоторой билинейной формы $b$ по правилу:
    $$ q(v) = b(v, v) $$
    *Важное замечание:* Разные билинейные формы могут порождать одну и ту же квадратичную форму! Например, если $b = b_S + b_{AS}$, то $q(v) = b(v, v) = b_S(v, v) + b_{AS}(v, v)$. Но $b_{AS}(v, v) = -b_{AS}(v, v)$, откуда (если $1+1 \neq 0$ в $K$) следует $b_{AS}(v, v) = 0$. Таким образом, $q(v) = b_S(v, v)$.
    *Вывод:* Любая квадратичная форма однозначно определяется *симметричной* частью порождающей ее билинейной формы. Поэтому часто говорят о квадратичной форме, *ассоциированной* с симметричной билинейной формой.

*   **Поляризация квадратичной формы:**
    Если задана квадратичная форма $q$, то соответствующую ей *симметричную* билинейную форму $b_S$ можно восстановить по формуле поляризации (для полей характеристики $\neq 2$):
    $$ b_S(u, v) = \frac{1}{2} (q(u+v) - q(u) - q(v)) $$
    (Существуют и другие эквивалентные формулы).

*   **Матрица квадратичной формы:**
    **Матрицей** квадратичной формы $q$ (в базисе $\{e_i\}$) называется матрица $B_S$ соответствующей ей *симметричной* билинейной формы. То есть, $Q = B_S = (\beta^S_{ij})$, где $\beta^S_{ij} = b_S(e_i, e_j)$.
    *Выражение через координаты:* Если $v = \sum v_i e_i$, то
    $$ q(v) = \sum_{i=1}^n \sum_{j=1}^n \beta^S_{ij} v_i v_j = V^T Q V $$
    В развернутом виде:
    $$ q(v) = \sum_{i=1}^n \beta^S_{ii} (v_i)^2 + \sum_{i < j} 2 \beta^S_{ij} v_i v_j $$
    Квадратичная форма является однородным многочленом второй степени от координат вектора.

## 3. Ключевые свойства и теоремы (формулировки)

1.  **Изоморфизм пространства билинейных форм и матриц:** Пространство $Bil_K(V)$ всех билинейных форм на $n$-мерном пространстве $V$ изоморфно пространству квадратных матриц $M_n(K)$. Этот изоморфизм зависит от выбора базиса в $V$.
    $$ b \leftrightarrow B = (b(e_i, e_j)) $$
2.  **Подпространства симметричных и антисимметричных форм:** Множества симметричных билинейных форм $Bil^S_K(V)$ и антисимметричных билинейных форм $Bil^{AS}_K(V)$ являются подпространствами в $Bil_K(V)$. Если $\operatorname{char} K \neq 2$, то $Bil_K(V) = Bil^S_K(V) \oplus Bil^{AS}_K(V)$ (прямая сумма).
3.  **Соответствие квадратичных и симметричных билинейных форм:** Для полей характеристики $\neq 2$ существует взаимно однозначное соответствие между квадратичными формами и симметричными билинейными формами, задаваемое соотношениями $q(v) = b_S(v, v)$ и формулой поляризации.
4.  **Преобразование матрицы билинейной формы при замене базиса:** Пусть $\{e_i\}$ и $\{e'_k\}$ — два базиса в $V$, связанные матрицей перехода $C$ ($e'_k = \sum_i c^i_k e_i$). Если билинейная форма $b$ имеет матрицу $B$ в базисе $\{e_i\}$ и матрицу $B'$ в базисе $\{e'_k\}$, то они связаны соотношением:
    $$ B' = C^T B C $$
    (Здесь $C^T$ — транспонированная матрица перехода).
5.  **Преобразование матрицы квадратичной формы:** Поскольку матрица квадратичной формы $Q$ — это матрица соответствующей симметричной билинейной формы, она преобразуется по тому же закону:
    $$ Q' = C^T Q C $$
    Матрицы $A$ и $B$, связанные соотношением $B = C^T A C$ с невырожденной матрицей $C$, называются **конгруэнтными**. Таким образом, при смене базиса матрица билинейной (и квадратичной) формы переходит в конгруэнтную ей матрицу.

## 4. Иллюстративные примеры

*   **Пример 1: Найти матрицу билинейной формы.**
    В $\mathbb{R}^2$ задана форма $b(u, v) = u_1 v_1 + 2 u_1 v_2 - u_2 v_1 + 3 u_2 v_2$, где $u=(u_1, u_2), v=(v_1, v_2)$ в стандартном базисе $e_1=(1,0), e_2=(0,1)$. Найдем ее матрицу $B$.
    *   $\beta_{11} = b(e_1, e_1) = b((1,0), (1,0)) = 1(1) + 2(1)(0) - 0(1) + 3(0)(0) = 1$.
    *   $\beta_{12} = b(e_1, e_2) = b((1,0), (0,1)) = 1(0) + 2(1)(1) - 0(0) + 3(0)(1) = 2$.
    *   $\beta_{21} = b(e_2, e_1) = b((0,1), (1,0)) = 0(1) + 2(0)(0) - 1(1) + 3(1)(0) = -1$.
    *   $\beta_{22} = b(e_2, e_2) = b((0,1), (0,1)) = 0(0) + 2(0)(1) - 1(0) + 3(1)(1) = 3$.
    Матрица:
    $$ B = \begin{pmatrix} 1 & 2 \\ -1 & 3 \end{pmatrix} $$

*   **Пример 2: Найти симметричную и антисимметричную части.**
    Для формы из Примера 1:
    $$ B_S = \frac{1}{2}(B + B^T) = \frac{1}{2} \left( \begin{pmatrix} 1 & 2 \\ -1 & 3 \end{pmatrix} + \begin{pmatrix} 1 & -1 \\ 2 & 3 \end{pmatrix} \right) = \frac{1}{2} \begin{pmatrix} 2 & 1 \\ 1 & 6 \end{pmatrix} = \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} $$
    $$ B_{AS} = \frac{1}{2}(B - B^T) = \frac{1}{2} \left( \begin{pmatrix} 1 & 2 \\ -1 & 3 \end{pmatrix} - \begin{pmatrix} 1 & -1 \\ 2 & 3 \end{pmatrix} \right) = \frac{1}{2} \begin{pmatrix} 0 & 3 \\ -3 & 0 \end{pmatrix} = \begin{pmatrix} 0 & 3/2 \\ -3/2 & 0 \end{pmatrix} $$
    Проверка: $B_S + B_{AS} = B$.

*   **Пример 3: Найти квадратичную форму и ее матрицу.**
    Для формы $b$ из Примера 1, квадратичная форма $q(u) = b(u, u)$:
    $$ q(u) = u_1 u_1 + 2 u_1 u_1 - u_2 u_1 + 3 u_2 u_2 = u_1^2 + (2-1) u_1 u_2 + 3 u_2^2 = u_1^2 + u_1 u_2 + 3 u_2^2 $$
    Матрица этой квадратичной формы $Q$ - это симметричная матрица $B_S$, найденная в Примере 2:
    $$ Q = B_S = \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} $$
    Проверим: $U^T Q U = (u_1, u_2) \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} \begin{pmatrix} u_1 \\ u_2 \end{pmatrix} = (u_1, u_2) \begin{pmatrix} u_1 + \frac{1}{2}u_2 \\ \frac{1}{2}u_1 + 3u_2 \end{pmatrix} = u_1(u_1 + \frac{1}{2}u_2) + u_2(\frac{1}{2}u_1 + 3u_2) = u_1^2 + \frac{1}{2}u_1 u_2 + \frac{1}{2}u_1 u_2 + 3 u_2^2 = u_1^2 + u_1 u_2 + 3 u_2^2$. Совпадает!

*   **Пример 4: Преобразование матрицы при смене базиса.**
    Пусть квадратичная форма $q$ в стандартном базисе $\mathbb{R}^2$ имеет матрицу $Q = \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix}$. Найдем ее матрицу $Q'$ в базисе $e'_1=(1,1), e'_2=(1,-1)$.
    Матрица перехода от стандартного к новому базису: $C = \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}$.
    Формула преобразования: $Q' = C^T Q C$.
    $$ Q' = \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}^T \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} $$
    $$ Q' = \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} $$
    Сначала умножим две последние матрицы:
    $$ \begin{pmatrix} 1 & 1/2 \\ 1/2 & 3 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} = \begin{pmatrix} 1(1) + \frac{1}{2}(1) & 1(1) + \frac{1}{2}(-1) \\ \frac{1}{2}(1) + 3(1) & \frac{1}{2}(1) + 3(-1) \end{pmatrix} = \begin{pmatrix} 3/2 & 1/2 \\ 7/2 & -5/2 \end{pmatrix} $$
    Теперь умножим первую матрицу на результат:
    $$ Q' = \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} 3/2 & 1/2 \\ 7/2 & -5/2 \end{pmatrix} = \begin{pmatrix} 1(\frac{3}{2}) + 1(\frac{7}{2}) & 1(\frac{1}{2}) + 1(-\frac{5}{2}) \\ 1(\frac{3}{2}) + (-1)(\frac{7}{2}) & 1(\frac{1}{2}) + (-1)(-\frac{5}{2}) \end{pmatrix} $$
    $$ Q' = \begin{pmatrix} 10/2 & -4/2 \\ -4/2 & 6/2 \end{pmatrix} = \begin{pmatrix} 5 & -2 \\ -2 & 3 \end{pmatrix} $$
    Матрица квадратичной формы в новом базисе: $Q' = \begin{pmatrix} 5 & -2 \\ -2 & 3 \end{pmatrix}$. Заметьте, она осталась симметричной.

## 5. Резюме

*   **Билинейная форма** $b(u,v)$ — линейна по каждому аргументу. В базисе задается матрицей $B = (b(e_i, e_j))$.
*   Бывают **симметричные** ($b(u,v)=b(v,u)$, $B=B^T$) и **антисимметричные** ($b(u,v)=-b(v,u)$, $B=-B^T$). Любая форма (при $\operatorname{char} K \neq 2$) разлагается в их сумму.
*   **Квадратичная форма** $q(v) = b(v,v)$. Она однозначно соответствует *симметричной* части $b_S$ формы $b$. Задается симметричной матрицей $Q=B_S$.
*   Значение форм через координаты: $b(u,v) = U^T B V$, $q(v) = V^T Q V$.
*   При смене базиса с матрицей перехода $C$, матрицы форм $B$ и $Q$ преобразуются по закону $B' = C^T B C$ и $Q' = C^T Q C$ (конгруэнтное преобразование).

Понимание билинейных и квадратичных форм открывает дорогу к важным темам, таким как приведение квадратичных форм к каноническому виду (сумме квадратов), закон инерции Сильвестра, критерий Сильвестра для знакоопределенности, евклидовы и унитарные пространства.