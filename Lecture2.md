# Лекция 2: Основные команды Ubuntu, перенаправление потоков, операторы условий и циклы в Bash

## Содержание

1. [Введение](#введение)
2. [Команда `sudo`](#команда-sudo)
3. [Основные команды Ubuntu](#основные-команды-ubuntu)
   - [`ls`](#1-ls-—-вывод-списка-файлов-и-папок)
   - [`cd`](#2-cd-—-изменение-текущей-директории)
   - [`pwd`](#3-pwd-—-вывод-текущего-пути)
   - [`cp`](#4-cp-—-копирование-файлов-и-папок)
   - [`rm`](#5-rm-—-удаление-файлов-и-папок)
   - [`history`](#6-history-—-история-команд)
   - [`mkdir`](#7-mkdir-—-создание-новой-директории)
   - [`df`](#8-df-—-информация-о-файловой-системе)
   - [`uname`](#9-uname-—-информация-о-системе)
   - [`passwd`](#10-passwd-—-смена-пароля-пользователя)
   - [`whereis`](#11-whereis-—-поиск-расположения-файлов)
4. [Перенаправление потоков ввода/вывода](#перенаправление-потоков-вводавывода)
5. [Оболочка Bash](#оболочка-bash)
   - [Специальные символы](#специальные-символы)
   - [Выполнение команд](#выполнение-команд)
   - [Переменные и параметры](#переменные-и-параметры)
6. [Команда `top`](#команда-top)
   - [Интерпретация вывода `top`](#интерпретация-вывода-top)
   - [Полезные клавиши в `top`](#полезные-клавиши-в-top)
7. [Перенаправление потоков ввода/вывода в Bash](#перенаправление-потоков-вводавывода-в-bash)
   - [Стандартные потоки](#стандартные-потоки)
   - [Перенаправление вывода](#перенаправление-вывода)
   - [Перенаправление ошибок](#перенаправление-ошибок)
   - [Перенаправление ввода](#перенаправление-ввода)
8. [Команда `grep`](#команда-grep)
   - [Основные опции `grep`](#основные-опции-grep)
   - [Примеры использования `grep`](#примеры-использования-grep)
9. [Операторы условий в Bash](#операторы-условий-в-bash)
   - [Условный оператор `if`](#условный-оператор-if)
   - [Оператор выбора `case`](#оператор-выбора-case)
10. [Циклы в Bash](#циклы-в-bash)
    - [Цикл `for`](#цикл-for)
    - [Цикл `while`](#цикл-while)
    - [Цикл `until`](#цикл-until)
11. [Заключение](#заключение)

---

## Введение

В данной лекции мы подробно рассмотрим:

- Основные команды Ubuntu для работы в терминале.
- Перенаправление потоков ввода и вывода в Bash.
- Операторы условий (`if`, `case`) и циклы (`for`, `while`, `until`) в языке Bash.

---

## Команда `sudo`

Команда `sudo` позволяет пользователю выполнять программы с привилегиями безопасности другого пользователя, обычно суперпользователя (root). Это необходимо для задач, требующих административных прав.

### Основные сведения о `sudo`

- **Расшифровка**: `sudo` — **S**uper **U**ser **DO**, что означает "выполнить от имени суперпользователя".
- **Назначение**: Предоставляет временные привилегии для выполнения определенных команд.
- **Настройка**: В большинстве современных дистрибутивов Linux `sudo` настраивается во время установки системы.

### Примеры использования

```bash
sudo apt-get update        # Обновление списка пакетов
sudo apt-get upgrade       # Обновление установленных пакетов
sudo apt-get install package_name  # Установка пакета
sudo apt-get remove package_name   # Удаление пакета
sudo apt-get purge package_name    # Полное удаление пакета с конфигурационными файлами
```

### Просмотр справки

Для получения полной информации о команде `sudo` можно использовать:

```bash
man sudo
```

---

## Основные команды Ubuntu

### 1. `ls` — Вывод списка файлов и папок

Выводит содержимое директории.

```bash
ls              # Список файлов в текущей директории
ls /path        # Список файлов в указанной директории
ls -l           # Подробный список с правами доступа
ls -a           # Отображение скрытых файлов (начинающихся с '.')
```

### 2. `cd` — Изменение текущей директории

Перемещение между директориями.

```bash
cd /path/to/directory   # Переход в указанную директорию
cd ..                   # Переход на уровень вверх
cd ~                    # Переход в домашнюю директорию
cd -                    # Возврат в предыдущую директорию
```

### 3. `pwd` — Вывод текущего пути

Показывает полный путь к текущей директории.

```bash
pwd
```

### 4. `cp` — Копирование файлов и папок

Копирует файлы и директории.

```bash
cp source_file destination           # Копирование файла
cp -r source_directory destination   # Рекурсивное копирование директории
```

### 5. `rm` — Удаление файлов и папок

Удаляет файлы и директории.

```bash
rm file                            # Удаление файла
rm -r directory                    # Рекурсивное удаление директории
rm -rf directory                   # Принудительное рекурсивное удаление (осторожно!)
```

### 6. `history` — История команд

Отображает историю введенных команд.

```bash
history                            # Вывод всей истории
history | grep "search_term"       # Поиск в истории
```

### 7. `mkdir` — Создание новой директории

Создает новые директории.

```bash
mkdir new_directory                # Создание одной директории
mkdir -p dir1/dir2/dir3            # Создание вложенных директорий
```

### 8. `df` — Информация о файловой системе

Отображает информацию о дисковом пространстве.

```bash
df -h      # Человекочитаемый формат
df -Th     # Включая типы файловых систем
```

### 9. `uname` — Информация о системе

Выводит информацию об операционной системе и ядре.

```bash
uname -a   # Полная информация
uname -r   # Версия ядра
uname -s   # Название операционной системы
```

### 10. `passwd` — Смена пароля пользователя

Изменение пароля текущего или указанного пользователя.

```bash
passwd         # Смена пароля текущего пользователя
sudo passwd user_name   # Смена пароля другого пользователя (требует прав root)
```

### 11. `whereis` — Поиск расположения файлов

Находит расположение исполняемых файлов, исходных кодов и страниц руководства.

```bash
whereis bash         # Информация о расположении bash
whereis ls           # Информация о расположении ls
```

---

## Перенаправление потоков ввода/вывода

Перенаправление позволяет отправлять вывод одной команды в другую команду, файл или устройство.

- **`>`**: Перенаправление вывода в файл (перезапись)
- **`>>`**: Перенаправление вывода в файл (добавление)
- **`<`**: Перенаправление ввода из файла
- **`|`**: Пайп (передача вывода одной команды на ввод другой)

**Примеры:**

```bash
ls > file_list.txt            # Сохранение списка файлов в файл
cat file1 file2 > combined.txt  # Объединение файлов
grep "error" logfile.txt > errors.txt  # Сохранение строк с "error" в отдельный файл
```

---

## Оболочка Bash

Bash — это командная оболочка Unix, предоставляющая интерфейс командной строки для взаимодействия с операционной системой.

### Специальные символы

- **Метасимволы**:
  - `*` — Любое количество символов
  - `?` — Один любой символ
  - `[]` — Любой из указанных символов
- **Кавычки**:
  - **Одинарные `'`**: Полная защита от интерпретации (не подставляются переменные)
  - **Двойные `"`**: Разрешают интерполяцию переменных и специальных символов
  - **Обратные `` ` ``**: Выполнение команд внутри строки
- **Перенаправление**:
  - `>`: Перенаправление вывода
  - `<`: Перенаправление ввода
  - `>>`: Добавление к существующему файлу
- **Пайпы**:
  - `|`: Передача вывода одной команды на ввод другой

### Выполнение команд

- **Последовательное выполнение**: Использование `;` для разделения команд.

  ```bash
  command1; command2; command3
  ```

- **Параллельное выполнение**: Использование `&` для запуска команды в фоновом режиме.

  ```bash
  command1 & command2 &
  ```

- **Условное выполнение**:
  - **`&&`**: Вторая команда выполняется, если первая завершилась успешно.

    ```bash
    command1 && command2
    ```

  - **`||`**: Вторая команда выполняется, если первая завершилась с ошибкой.

    ```bash
    command1 || command2
    ```

### Переменные и параметры

- **Объявление переменной**:

  ```bash
  VARIABLE_NAME="value"   # Без пробелов вокруг "="
  ```

- **Использование переменной**:

  ```bash
  echo $VARIABLE_NAME
  ```

- **Специальные переменные**:
  - `$0`: Имя текущего скрипта
  - `$1`...`$9`: Позиционные параметры
  - `$#`: Количество аргументов
  - `$@`: Все аргументы скрипта
  - `$$`: PID текущего процесса
  - `$?`: Код возврата последней выполненной команды
  - `$USER`: Имя текущего пользователя
  - `$HOME`: Домашняя директория пользователя
  - `$PATH`: Переменная окружения с путями для поиска исполняемых файлов

---

## Команда `top`

`top` — утилита для мониторинга системных ресурсов в режиме реального времени.

### Интерпретация вывода `top`

- **Заголовок**: Отображает текущую дату, время работы системы (аптайм), количество пользователей и среднюю загрузку за 1, 5 и 15 минут.
- **Процессы**:
  - **PID**: Идентификатор процесса
  - **USER**: Пользователь, запустивший процесс
  - **PR**: Приоритет процесса
  - **NI**: Значение nice для процесса
  - **VIRT**: Виртуальная память, используемая процессом
  - **RES**: Резидентная память (в RAM)
  - **SHR**: Разделяемая память
  - **S**: Состояние процесса (R — выполняется, S — спит, Z — зомби)
  - **%CPU**: Процент использования CPU
  - **%MEM**: Процент использования RAM
  - **TIME+**: Общее время CPU, использованное процессом
  - **COMMAND**: Имя команды или процесса

### Полезные клавиши в `top`

- `h`: Справка по команде `top`
- `q`: Выход из `top`
- `Shift + M`: Сортировка по использованию памяти
- `Shift + P`: Сортировка по использованию CPU
- `k`: Завершение процесса по PID
- `u`: Фильтрация процессов по пользователю

**Пример использования `top`:**

```bash
top   # Запуск утилиты
```

---

## Перенаправление потоков ввода/вывода в Bash

### Стандартные потоки

- **Стандартный ввод (stdin)**: Файловый дескриптор `0`
- **Стандартный вывод (stdout)**: Файловый дескриптор `1`
- **Стандартный вывод ошибок (stderr)**: Файловый дескриптор `2`

### Перенаправление вывода

- **Перезапись файла**:

  ```bash
  command > file.txt    # stdout в файл
  ```

- **Добавление в конец файла**:

  ```bash
  command >> file.txt   # stdout добавляется в файл
  ```

### Перенаправление ошибок

- **Перенаправление stderr в файл**:

  ```bash
  command 2> error.log
  ```

- **Перенаправление stdout и stderr в один файл**:

  ```bash
  command > output.log 2>&1
  ```

### Перенаправление ввода

- **Чтение из файла вместо stdin**:

  ```bash
  command < input.txt
  ```

### Примеры

- **Запись вывода и ошибок в отдельные файлы**:

  ```bash
  ls -l > output.txt 2> errors.txt
  ```

- **Сокращенная запись для перенаправления stdout и stderr**:

  ```bash
  command &> combined.txt
  ```

---

## Команда `grep`

`grep` — утилита для поиска строк, соответствующих заданному шаблону.

### Основные опции `grep`

- `-i`: Игнорировать регистр при поиске
- `-v`: Инвертировать результат поиска (вывести строки, не соответствующие шаблону)
- `-c`: Подсчитать количество совпадений
- `-n`: Нумеровать строки с совпадениями
- `-r`: Рекурсивный поиск в директориях
- `-l`: Вывести только имена файлов с совпадениями
- `-w`: Поиск целых слов
- `-A NUM`: Вывести NUM строк после совпадения
- `-B NUM`: Вывести NUM строк перед совпадением
- `-C NUM`: Вывести NUM строк до и после совпадения

### Примеры использования `grep`

- **Поиск строки в файле**:

  ```bash
  grep "search_term" filename.txt
  ```

- **Поиск без учета регистра**:

  ```bash
  grep -i "search_term" filename.txt
  ```

- **Поиск в нескольких файлах**:

  ```bash
  grep "search_term" file1.txt file2.txt
  ```

- **Рекурсивный поиск в директории**:

  ```bash
  grep -r "search_term" /path/to/directory/
  ```

- **Поиск и вывод строк с номерами**:

  ```bash
  grep -n "search_term" filename.txt
  ```

- **Инвертированный поиск**:

  ```bash
  grep -v "exclude_term" filename.txt
  ```

- **Поиск целого слова**:

  ```bash
  grep -w "word" filename.txt
  ```

- **Вывод строк вокруг совпадения**:

  ```bash
  grep -C 2 "search_term" filename.txt   # 2 строки до и после
  ```

---

## Операторы условий в Bash

### Условный оператор `if`

Позволяет выполнять команды в зависимости от выполнения условия.

**Синтаксис:**

```bash
if [ условие ]; then
    # Команды, если условие истинно
elif [ условие ]; then
    # Команды, если предыдущее условие ложно, а это истинно
else
    # Команды, если все условия ложны
fi
```

**Примеры условий:**

- Числовые сравнения:
  - `-eq`: равно (`==`)
  - `-ne`: не равно (`!=`)
  - `-lt`: меньше (`<`)
  - `-le`: меньше или равно (`<=`)
  - `-gt`: больше (`>`)
  - `-ge`: больше или равно (`>=`)
- Строковые сравнения:
  - `=`: равно
  - `!=`: не равно
  - `<`: меньше по алфавиту
  - `>`: больше по алфавиту
- Проверка файлов:
  - `-e`: существует ли файл
  - `-d`: является ли каталогом
  - `-f`: является ли файлом
  - `-s`: файл не пустой

**Пример использования:**

```bash
read -p "Введите ваше имя: " NAME
if [ "$NAME" = "admin" ]; then
    echo "Здравствуйте, администратор!"
else
    echo "Здравствуйте, $NAME!"
fi
```

### Оператор выбора `case`

Используется для многовариантного выбора, аналогично `switch` в других языках.

**Синтаксис:**

```bash
case "$VARIABLE" in
    pattern1)
        # Команды для pattern1
        ;;
    pattern2)
        # Команды для pattern2
        ;;
    *)
        # Команды по умолчанию
        ;;
esac
```

**Пример использования:**

```bash
read -p "Выберите действие (start/stop/restart): " ACTION
case "$ACTION" in
    start)
        echo "Сервис запускается..."
        ;;
    stop)
        echo "Сервис останавливается..."
        ;;
    restart)
        echo "Сервис перезапускается..."
        ;;
    *)
        echo "Неизвестное действие: $ACTION"
        ;;
esac
```

---

## Циклы в Bash

### Цикл `for`

Позволяет повторно выполнять команды для каждого элемента в списке.

**Синтаксис:**

```bash
for VARIABLE in LIST; do
    # Команды
done
```

**Пример использования:**

```bash
for FILE in *.txt; do
    echo "Обработка файла $FILE"
    # Дополнительные команды
done
```

**С использованием числовой последовательности:**

```bash
for (( i=1; i<=5; i++ )); do
    echo "Итерация $i"
done
```

### Цикл `while`

Выполняет команды, пока условие истинно.

**Синтаксис:**

```bash
while [ условие ]; do
    # Команды
done
```

**Пример использования:**

```bash
COUNT=0
while [ $COUNT -lt 5 ]; do
    echo "Счетчик: $COUNT"
    COUNT=$((COUNT + 1))
done
```

### Цикл `until`

Выполняет команды, пока условие ложно.

**Синтаксис:**

```bash
until [ условие ]; do
    # Команды
done
```

**Пример использования:**

```bash
NUMBER=10
until [ $NUMBER -eq 0 ]; do
    echo "Обратный отсчет: $NUMBER"
    NUMBER=$((NUMBER - 1))
done
```

---

## Заключение

В данной лекции мы подробно разобрали:

- Основные команды Ubuntu для работы с файловой системой и процессами.
- Перенаправление потоков ввода/вывода и их использование для управления выводом и вводом команд.
- Использование оболочки Bash для автоматизации задач, написания скриптов с условиями и циклами.
- Практические примеры использования условных операторов `if` и `case`, а также циклов `for`, `while` и `until`.

Эти знания являются фундаментальными для эффективной работы в терминале, администрирования систем и автоматизации повседневных задач.

---

**Рекомендуемая практика:**

- Попробуйте написать скрипт, который будет обрабатывать файлы в заданной директории, используя циклы и условия.
- Экспериментируйте с перенаправлением потоков для создания логов выполнения ваших скриптов.
- Изучите дополнительные опции команд `grep`, `awk`, `sed` для более сложной обработки текстовых данных.

---

**Полезные ресурсы:**

- [Официальная документация Bash](https://www.gnu.org/software/bash/manual/bash.html)
- [Руководство по командам Linux](https://www.linuxcommand.org/)
- [Advanced Bash-Scripting Guide](https://tldp.org/LDP/abs/html/)
