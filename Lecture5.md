# Лекция 5: Сетевые службы DNS, DHCP и NAT. Обзор Cisco Packet Tracer

## Содержание

1. [Введение](#введение)
2. [Network Address Translation (NAT)](#network-address-translation-nat)
   - [Что такое NAT](#что-такое-nat)
   - [Как работает NAT](#как-работает-nat)
   - [Терминология NAT](#терминология-nat)
   - [Типы NAT](#типы-nat)
   - [Преимущества и недостатки NAT](#преимущества-и-недостатки-nat)
3. [Dynamic Host Configuration Protocol (DHCP)](#dynamic-host-configuration-protocol-dhcp)
   - [Что такое DHCP](#что-такое-dhcp)
   - [Типы распределения IP-адресов](#типы-распределения-ip-адресов)
   - [Как работает DHCP](#как-работает-dhcp)
4. [Domain Name System (DNS)](#domain-name-system-dns)
   - [Что такое DNS](#что-такое-dns)
   - [Как работает DNS](#как-работает-dns)
   - [DNS-зоны](#dns-зоны)
5. [Обзор Cisco Packet Tracer](#обзор-cisco-packet-tracer)
   - [Введение в Cisco Packet Tracer](#введение-в-cisco-packet-tracer)
   - [Основные возможности](#основные-возможности)
   - [Использование для лабораторных работ](#использование-для-лабораторных-работ)
6. [Заключение](#заключение)

---

## Введение

В этой лекции мы познакомимся с ключевыми сетевыми службами, такими как:

- **NAT (Network Address Translation)** — перевод сетевых адресов.
- **DHCP (Dynamic Host Configuration Protocol)** — протокол динамической конфигурации узла.
- **DNS (Domain Name System)** — система доменных имен.

Также кратко рассмотрим **Cisco Packet Tracer**, инструмент для моделирования сетей, который будет использоваться в пятой лабораторной работе.

---

## Network Address Translation (NAT)

### Что такое NAT

**Network Address Translation (NAT)** — это технология, позволяющая преобразовывать частные IP-адреса внутренних сетей в общедоступные публичные IP-адреса и наоборот. Это позволяет устройствам с частными адресами обращаться к внешним сетям, таким как Интернет.

### Как работает NAT

- **Частные IP-адреса** используются внутри локальных сетей и не маршрутизируются в Интернете.
- **Публичные IP-адреса** используются для доступа к внешним ресурсам и должны быть уникальными в глобальном масштабе.
- **Маршрутизатор с поддержкой NAT** переводит частные адреса в публичные при выходе в Интернет и обратно при входящих соединениях.

**Схема работы:**

1. **Внутреннее устройство** с частным IP-адресом отправляет пакет на внешний ресурс.
2. **Маршрутизатор NAT** изменяет исходный частный IP-адрес на публичный IP-адрес из своего пула.
3. **Внешний ресурс** отвечает на запрос, отправляя пакет на публичный IP-адрес маршрутизатора.
4. **Маршрутизатор NAT** принимает ответ и перенаправляет его на соответствующее внутреннее устройство, используя таблицу соответствия адресов.

### Терминология NAT

- **Inside Local Address**: Внутренний локальный адрес устройства внутри сети (частный IP-адрес).
- **Inside Global Address**: Внутренний глобальный адрес, под которым внутреннее устройство видно в Интернете (публичный IP-адрес маршрутизатора).
- **Outside Local Address**: Внешний адрес назначения, как он виден из внутренней сети (обычно совпадает с Outside Global Address).
- **Outside Global Address**: Реальный публичный IP-адрес внешнего устройства или ресурса.

**Пример:**

- **Внутренний компьютер** с адресом `192.168.1.5` (Inside Local Address) хочет связаться с веб-сервером в Интернете.
- **Маршрутизатор NAT** преобразует этот адрес в свой публичный адрес `94.165.76.11` (Inside Global Address).
- **Веб-сервер** имеет публичный IP-адрес `194.165.77.54` (Outside Global Address).
- Ответы от веб-сервера проходят обратный путь, и маршрутизатор NAT перенаправляет их на внутренний компьютер `192.168.1.5`.

### Типы NAT

1. **Статический NAT (Static NAT)**
   - Сопоставление один-к-одному между частным и публичным IP-адресом.
   - Используется для устройств, которые должны быть постоянно доступны из внешних сетей (например, веб-серверы).

2. **Динамический NAT (Dynamic NAT)**
   - Использует пул публичных IP-адресов.
   - Адреса из пула назначаются внутренним устройствам по мере необходимости.
   - Принцип "кто первый встал, того и тапочки".

3. **Перевод сетевых адресов портов (PAT, Port Address Translation)**
   - Также известен как NAT Overload.
   - Позволяет множеству внутренних устройств использовать один публичный IP-адрес.
   - Различает сеансы по номерам портов TCP/UDP.
   - Наиболее распространен в домашних и офисных сетях.

### Преимущества и недостатки NAT

**Преимущества:**

- **Экономия публичных IP-адресов**: Один публичный IP-адрес может обслуживать множество устройств.
- **Безопасность**: Скрывает внутреннюю структуру сети от внешних пользователей.
- **Гибкость**: Упрощает изменение внутренней адресации без влияния на внешние соединения.

**Недостатки:**

- **Увеличение задержек**: Процесс преобразования адресов требует дополнительного времени.
- **Проблемы со сквозной связью**: Сложнее установить прямое соединение между внутренними и внешними устройствами.
- **Трудности с некоторыми протоколами**: Протоколы, требующие сквозную адресацию (например, IPsec), могут работать некорректно.
- **Ограничения реального времени**: Приложения реального времени могут испытывать дополнительные задержки.

---

## Dynamic Host Configuration Protocol (DHCP)

### Что такое DHCP

**DHCP (Dynamic Host Configuration Protocol)** — сетевой протокол, позволяющий устройствам автоматически получать IP-адреса и другие параметры конфигурации сети (маска подсети, шлюз по умолчанию, адреса DNS-серверов).

### Типы распределения IP-адресов

1. **Ручное распределение (Manual Allocation)**
   - Администратор вручную сопоставляет MAC-адрес устройства с IP-адресом.
   - DHCP-сервер предоставляет этот IP-адрес устройству при запросе.

2. **Автоматическое распределение (Automatic Allocation)**
   - DHCP-сервер автоматически назначает постоянный IP-адрес из пула доступных адресов.
   - Адрес остается закрепленным за устройством на постоянной основе.

3. **Динамическое распределение (Dynamic Allocation)**
   - Наиболее распространенный метод.
   - IP-адреса выдаются на ограниченный период времени (аренда).
   - После истечения срока аренды устройство должно запросить адрес заново.

### Как работает DHCP

**Процесс получения IP-адреса:**

1. **DHCP Discover**
   - Клиент отправляет широковещательное сообщение в сеть, чтобы обнаружить DHCP-серверы.
   - Используются адреса назначения `255.255.255.255` и исходный адрес `0.0.0.0`.

2. **DHCP Offer**
   - DHCP-серверы, получившие запрос, отвечают предложением IP-адреса и параметров конфигурации.

3. **DHCP Request**
   - Клиент выбирает одно из предложений и отправляет запрос на подтверждение выбранного IP-адреса.

4. **DHCP Acknowledgment (ACK)**
   - Сервер подтверждает аренду IP-адреса и отправляет окончательные параметры конфигурации.
   - Клиент может начать использовать полученный IP-адрес.

**Продление аренды:**

- Перед истечением срока аренды клиент отправляет DHCP Request на продление.
- Если сервер доступен, он обновляет аренду и отправляет DHCP ACK.
- Если сервер недоступен, клиент пытается связаться с другими DHCP-серверами.

---

## Domain Name System (DNS)

### Что такое DNS

**DNS (Domain Name System)** — система, позволяющая преобразовывать легко запоминаемые доменные имена (например, `www.example.com`) в IP-адреса, необходимые для установления соединения в сети.

### Как работает DNS

- Когда пользователь вводит доменное имя в браузере, его компьютер отправляет запрос на DNS-сервер.
- **DNS-сервер** ищет соответствующий IP-адрес в своей базе данных или кэше.
- Если запись найдена, сервер возвращает IP-адрес клиенту.
- Если нет, сервер может запросить информацию у других DNS-серверов.

**Кэширование DNS-запросов:**

- Для ускорения последующих запросов DNS-серверы и клиенты кэшируют результаты предыдущих запросов.
- Это уменьшает нагрузку на сеть и сокращает время доступа к часто используемым ресурсам.

### DNS-зоны

- **DNS-зона** — часть пространства имен DNS, управляемая конкретным сервером или организацией.
- Зона содержит записи, связывающие доменные имена с IP-адресами и другими ресурсами.

**Типы записей в DNS-зоне:**

- **A-запись**: Соответствие доменного имени IPv4-адресу.
- **AAAA-запись**: Соответствие доменного имени IPv6-адресу.
- **MX-запись**: Указывает почтовые серверы для домена.
- **CNAME-запись**: Псевдоним для другого доменного имени.
- **NS-запись**: Указывает авторитетные DNS-серверы для зоны.

**Пример:**

- **Доменное имя**: `mail.example.com`
- **A-запись**: `mail.example.com` -> `192.0.2.10`
- **MX-запись**: Указывает, что почта для `example.com` должна направляться на `mail.example.com`.

---

## Обзор Cisco Packet Tracer

### Введение в Cisco Packet Tracer

**Cisco Packet Tracer** — это программное обеспечение для моделирования и симуляции компьютерных сетей. Разработано компанией Cisco и позволяет создавать сложные сетевые топологии и настраивать их работу без необходимости использования физического оборудования.

### Основные возможности

- **Создание сетевых топологий** с использованием разнообразных устройств: маршрутизаторов, коммутаторов, серверов, компьютеров и т.д.
- **Настройка устройств** через графический интерфейс или командную строку.
- **Моделирование сетевых протоколов** и их взаимодействия.
- **Отладка и анализ сетевого трафика** с помощью встроенных инструментов.
- **Обучение и подготовка к сертификационным экзаменам Cisco**.

### Использование для лабораторных работ

- **Установка**: Инструкции по установке Cisco Packet Tracer предоставлены в дополнительных материалах к лабораторной работе.
- **Интерфейс пользователя**:
  - **Панель устройств**: Находится в нижней части окна и содержит категории устройств (маршрутизаторы, коммутаторы, компьютеры и т.д.).
  - **Рабочая область**: Центральная часть, где размещаются и соединяются устройства.
  - **Панель инструментов**: Позволяет выбирать типы соединений и переключаться между режимами реального времени и симуляции.
- **Создание сети**:
  - Выберите устройство в панели и разместите его на рабочей области.
  - Соедините устройства с помощью соответствующих кабелей (витая пара, оптоволокно и т.д.).
- **Настройка устройств**:
  - Дважды кликните на устройстве, чтобы открыть окно настроек.
  - **Маршрутизаторы и коммутаторы**: Могут быть настроены через командную строку (CLI) или графический интерфейс (GUI).
  - **Компьютеры и серверы**: Настройка IP-адресов, масок подсети, шлюзов и DNS-серверов.
- **Проверка работоспособности**:
  - Используйте команды `ping`, `traceroute` для проверки связи между устройствами.
  - В режиме симуляции можно просмотреть детальную информацию о прохождении пакетов по сети.

**Советы для лабораторной работы**:

- **Внимательно следуйте инструкциям** в описании лабораторной работы.
- **Сохраняйте промежуточные результаты**, чтобы иметь возможность вернуться к предыдущему состоянию сети.
- **Используйте встроенные инструменты** для отладки и анализа сетевых настроек.

---

## Заключение

В этой лекции мы рассмотрели три ключевые сетевые службы:

- **NAT**: Позволяет устройствам с частными IP-адресами взаимодействовать с внешними сетями, переводя адреса.
- **DHCP**: Обеспечивает автоматическую конфигурацию сетевых параметров для устройств в сети.
- **DNS**: Система, связывающая доменные имена с IP-адресами, облегчая доступ к ресурсам в сети.

Также мы познакомились с **Cisco Packet Tracer**, инструментом для моделирования сетей, который будет использоваться для практических занятий и лабораторных работ.

**Рекомендуемая практика**:

- **Исследуйте** настройки NAT на домашнем маршрутизаторе.
- **Настройте** DHCP-сервер в Cisco Packet Tracer и наблюдайте за процессом получения IP-адресов клиентами.
- **Создайте** простую сеть с DNS-сервером и настройте разрешение имен для нескольких узлов.

---

**Дополнительные ресурсы**:

- **Официальная документация Cisco Packet Tracer**
- **RFC 1918**: Адресное пространство частных сетей
- **RFC 2131**: Dynamic Host Configuration Protocol
- **RFC 1035**: Domain Names - Implementation and Specification

**Желаем успехов в изучении и выполнении лабораторных работ!**
